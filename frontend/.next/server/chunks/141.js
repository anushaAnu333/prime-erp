"use strict";exports.id=141,exports.ids=[141],exports.modules={5204:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(55016),e=c(43161);let f=({isOpen:a,onClose:b,title:c,message:f,children:g,type:h="info",showCloseButton:i=!0,onConfirm:j,confirmText:k="OK",cancelText:l="Cancel",showCancelButton:m=!1,size:n="md"})=>{if((0,e.useEffect)(()=>{let c=a=>{"Escape"===a.key&&b()};return a&&(document.addEventListener("keydown",c),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",c),document.body.style.overflow="unset"}},[a,b]),!a)return null;let o=(()=>{switch(h){case"success":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),iconBg:"bg-green-100",iconColor:"text-green-600",titleColor:"text-green-800",borderColor:"border-green-200"};case"error":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),iconBg:"bg-red-100",iconColor:"text-red-600",titleColor:"text-red-800",borderColor:"border-red-200"};case"warning":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),iconBg:"bg-yellow-100",iconColor:"text-yellow-600",titleColor:"text-yellow-800",borderColor:"border-yellow-200"};default:return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),iconBg:"bg-blue-100",iconColor:"text-blue-600",titleColor:"text-blue-800",borderColor:"border-blue-200"}}})(),p=(()=>{switch(n){case"sm":return"max-w-md";case"lg":return"max-w-2xl";default:return"max-w-lg"}})(),q=()=>{b()};return(0,d.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,d.jsxs)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:b}),(0,d.jsx)("div",{className:`relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full ${p}`,children:(0,d.jsxs)("div",{className:`border-l-4 ${o.borderColor}`,children:[(0,d.jsx)("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,d.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,d.jsx)("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full sm:mx-0 sm:h-10 sm:w-10 ${o.iconBg}`,children:(0,d.jsx)("div",{className:o.iconColor,children:o.icon})}),(0,d.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[c&&(0,d.jsx)("h3",{className:`text-lg font-medium leading-6 ${o.titleColor} mb-4`,children:c}),g?(0,d.jsx)("div",{className:"mt-2",children:g}):(0,d.jsx)("div",{className:"mt-2",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:f})})]})]})}),!g&&(0,d.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,d.jsx)("button",{type:"button",className:`inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm sm:ml-3 sm:w-auto ${"success"===h?"bg-green-600 hover:bg-green-500":"error"===h?"bg-red-600 hover:bg-red-500":"warning"===h?"bg-yellow-600 hover:bg-yellow-500":"bg-blue-600 hover:bg-blue-500"}`,onClick:()=>{j&&j(),b()},children:k}),m&&(0,d.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:q,children:l}),i&&!m&&(0,d.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:q,children:"Close"})]})]})})]})})}},31522:(a,b,c)=>{c.d(b,{default:()=>o});var d=c(55016),e=c(43161),f=c(60230),g=c(95239);let h=({value:a,onCustomerSelect:b,error:c=!1,disabled:f=!1,className:h=""})=>{let[i,j]=(0,e.useState)([]),[k,l]=(0,e.useState)(!1),m=async(a="")=>{l(!0);try{let b=new URLSearchParams;a&&b.append("search",a),b.append("limit","50");let c=`/api/customers?${b}`,d=await fetch(c);if(d.ok){let a=await d.json();j(a.customers)}else console.error("Failed to fetch customers")}catch(a){console.error("Error fetching customers:",a)}finally{l(!1)}};(0,e.useEffect)(()=>{m()},[]);let n=i.map(a=>({value:a._id,label:`${a.shopName} - ${a.name}`,customer:a}));return(0,d.jsxs)("div",{className:h,children:[(0,d.jsx)(g.A,{options:n,value:a,onChange:a=>{if(a&&b&&"function"==typeof b){let c=i.find(b=>b._id===a);c&&b(c)}},placeholder:"Select a customer",searchable:!0,loading:k,disabled:f,error:c,onSearch:a=>{m(a)},displayKey:"label",valueKey:"value"}),a&&(0,d.jsx)("div",{className:"mt-2 p-2 bg-gray-50 rounded-md",children:(()=>{let b=i.find(b=>b._id===a);return b?(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsx)("div",{className:"font-medium text-gray-900",children:b.shopName}),(0,d.jsxs)("div",{className:"text-gray-600",children:[b.name," • ",b.phoneNumber]}),(0,d.jsx)("div",{className:"text-gray-500 text-xs mt-1",children:b.address}),(0,d.jsxs)("div",{className:"text-gray-500 text-xs mt-1",children:["Balance: ₹",b.currentBalance?.toFixed(2)||"0.00"]})]}):null})()})]})},i=({value:a,onProductSelect:b,error:c=!1,disabled:f=!1,className:h="",placeholder:i="Select a product"})=>{let[j,k]=(0,e.useState)([]),[l,m]=(0,e.useState)(!1),n=async(a="")=>{m(!0);try{let b=new URLSearchParams;a&&b.append("search",a),b.append("limit","50");let c=await fetch(`/api/products?${b}`);if(c.ok){let a=await c.json();k(a.products)}else console.error("Failed to fetch products")}catch(a){console.error("Error fetching products:",a)}finally{m(!1)}};(0,e.useEffect)(()=>{n()},[]);let o=j.map(a=>({value:a.name,label:a.name,product:a}));return(0,d.jsx)("div",{className:h,children:(0,d.jsx)(g.A,{options:o,value:a,onChange:a=>{if(a&&b&&"function"==typeof b){let c=j.find(b=>b.name===a);c&&b(c)}},placeholder:i||"Select a product",searchable:!0,loading:l,disabled:f,error:c,onSearch:a=>{n(a)},displayKey:"label",valueKey:"value"})})};var j=c(46859),k=c(17175),l=c(73723),m=c(61193),n=c(5204);let o=({initialData:a=null,mode:b="create",onSave:c=null,onCancel:o=null})=>{let p=(0,f.useRouter)(),[q,r]=(0,e.useState)(!1),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)(!1),[w,x]=(0,e.useState)(null),[y,z]=(0,e.useState)({customerId:"",customerName:"",date:new Date().toISOString().split("T")[0],discount:0,notes:""}),[A,B]=(0,e.useState)([{product:"",expiryDate:"",qty:"",rate:"",unit:"",taxableValue:0,gst:0,invoiceValue:0,productDetails:null}]),[C,D]=(0,e.useState)({taxableValue:0,gst:0,invoiceValue:0,total:0}),[E,F]=(0,e.useState)([]),G=["kg","packet","piece","dozen","box"];(0,e.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/products");if(a.ok){let b=await a.json();F(b.products||[])}}catch(a){console.error("Error fetching products:",a)}})()},[]),(0,e.useEffect)(()=>{a&&"edit"===b&&(z({customerId:a.customerId||"",customerName:a.customerName||"",date:a.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],discount:a.discount||0,notes:a.notes||""}),a.items&&a.items.length>0&&B(a.items.map(a=>({product:a.product||"",expiryDate:a.expiryDate||"",qty:a.qty||"",rate:a.rate||"",unit:a.unit||"",taxableValue:a.taxableValue||0,gst:a.gst||0,invoiceValue:a.invoiceValue||0,productDetails:null}))))},[a,b]),(0,e.useEffect)(()=>{let a=0,b=0,c=0;A.forEach(d=>{a+=d.taxableValue||0,b+=d.gst||0,c+=d.invoiceValue||0});let d=parseFloat(y.discount)||0,e=c-d;D({taxableValue:a,gst:b,invoiceValue:c,total:e})},[A,y.discount]);let H=(a,b)=>{z(c=>({...c,[a]:b}))},I=(a,b,c)=>{let d=[...A];if(d[a]={...d[a],[b]:c},"qty"===b||"rate"===b){let b=parseFloat(d[a].qty)||0,c=parseFloat(d[a].rate)||0,e=d[a].product,f=d[a].productDetails;if(e&&b&&c){let g=(0,j.Rf)(f||e,b,c,d[a].expiryDate);d[a]={...d[a],taxableValue:g.taxableValue,gst:g.gst,invoiceValue:g.invoiceValue}}}B(d)},J=()=>{z({customerId:"",customerName:"",date:new Date().toISOString().split("T")[0],discount:0,notes:""}),B([{product:"",expiryDate:"",qty:"",rate:"",unit:"",taxableValue:0,gst:0,invoiceValue:0,productDetails:null}]),D({taxableValue:0,gst:0,invoiceValue:0,total:0})},K=async d=>{d.preventDefault(),r(!0),t("");try{let d={customerId:y.customerId,customerName:y.customerName,items:A.map(a=>({product:a.product.toLowerCase(),qty:parseFloat(a.qty),rate:parseFloat(a.rate),unit:a.unit,hsnCode:a.productDetails?.hsnCode||"",expiryDate:a.expiryDate})),discount:parseFloat(y.discount),date:y.date,notes:y.notes},e="edit"===b?`/api/sales/${a.id}`:"/api/sales",f=await fetch(e,{method:"edit"===b?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(f.ok){let a=await f.json();c?c(a):(x(a),v(!0),J())}else{let a=await f.json();t(a.message||"Failed to save invoice")}}catch(a){console.error("Error saving invoice:",a),t("Failed to save invoice")}finally{r(!1)}};return(0,d.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,d.jsxs)(m.A,{className:"p-8",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,d.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"create"===b?"Create Sales Invoice":"Edit Sales Invoice"}),(0,d.jsx)("div",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString()})]}),s&&(0,d.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,d.jsx)("p",{className:"text-red-600 font-medium",children:s})}),(0,d.jsxs)("form",{onSubmit:K,className:"space-y-8",children:[(0,d.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Invoice Details"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Date"}),(0,d.jsx)(l.A,{type:"date",value:y.date,onChange:a=>H("date",a.target.value),required:!0,className:"w-full"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer Name"}),(0,d.jsx)(h,{value:y?.customerId,onCustomerSelect:a=>{z(b=>({...b,customerId:a._id,customerName:a?.name}))},required:!0})]})]})]}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Items"}),(0,d.jsx)(k.A,{type:"button",onClick:()=>{B([...A,{product:"",expiryDate:"",qty:"",rate:"",unit:"",taxableValue:0,gst:0,invoiceValue:0,productDetails:null}])},className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg",children:"+ Add Item"})]}),A.map((a,b)=>{let c;return(0,d.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 bg-white shadow-sm",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,d.jsxs)("h4",{className:"text-lg font-medium text-gray-700",children:["Item ",b+1]}),A.length>1&&(0,d.jsx)(k.A,{type:"button",onClick:()=>{A.length>1&&B(A.filter((a,c)=>c!==b))},className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 text-sm rounded-lg",children:"Remove Item"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product"}),(0,d.jsx)(i,{value:a.product,onProductSelect:a=>((a,b)=>{let c=[...A];if(c[a]={...c[a],product:b.name,rate:b.rate,unit:b.unit,productDetails:b},c[a].qty&&b.rate){let d=(0,j.Rf)(b,c[a].qty,b.rate,c[a].expiryDate);c[a]={...c[a],taxableValue:d.taxableValue,gst:d.gst,invoiceValue:d.invoiceValue}}B(c)})(b,a),placeholder:"Select product...",required:!0})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HSN Code"}),(0,d.jsx)(l.A,{value:(c=a.product,E.find(a=>a.name.toLowerCase()===c.toLowerCase()))?.hsnCode||"",disabled:!0,className:"bg-gray-50 w-full",placeholder:"HSN Code"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date"}),(0,d.jsx)(l.A,{type:"date",value:a.expiryDate,onChange:a=>I(b,"expiryDate",a.target.value),required:!0,className:"w-full"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),(0,d.jsx)(l.A,{type:"number",value:a.qty,onChange:a=>I(b,"qty",a.target.value),placeholder:"Enter quantity",min:"0",step:"0.01",required:!0,className:"w-full"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),(0,d.jsx)(g.A,{options:G.map(a=>({value:a,label:a})),value:a.unit,onChange:a=>I(b,"unit",a),placeholder:"Unit",required:!0})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rate"}),(0,d.jsx)(l.A,{type:"number",value:a.rate,onChange:a=>I(b,"rate",a.target.value),placeholder:"Enter rate per unit",min:"0",step:"0.01",required:!0,className:"w-full"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 bg-gray-50 p-4 rounded-lg",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taxable Value"}),(0,d.jsx)(l.A,{value:`₹${a.taxableValue.toFixed(2)}`,disabled:!0,className:"bg-white border-gray-200 font-semibold"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"GST"}),(0,d.jsx)(l.A,{value:`₹${a.gst.toFixed(2)}`,disabled:!0,className:"bg-white border-gray-200 font-semibold"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Value"}),(0,d.jsx)(l.A,{value:`₹${a.invoiceValue.toFixed(2)}`,disabled:!0,className:"bg-white border-gray-200 font-semibold"})]})]})]},b)})]}),(0,d.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Invoice Summary"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Taxable Value"}),(0,d.jsx)(l.A,{value:`₹${C.taxableValue.toFixed(2)}`,disabled:!0,className:"bg-white border-gray-200 font-semibold"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total GST"}),(0,d.jsx)(l.A,{value:`₹${C.gst.toFixed(2)}`,disabled:!0,className:"bg-white border-gray-200 font-semibold"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount"}),(0,d.jsx)(l.A,{type:"number",value:y.discount,onChange:a=>H("discount",a.target.value),placeholder:"Enter discount amount",min:"0",step:"0.01",className:"w-full"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Invoice Value"}),(0,d.jsx)(l.A,{value:`₹${C.invoiceValue.toFixed(2)}`,disabled:!0,className:"bg-white border-gray-200 font-semibold"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Final Total"}),(0,d.jsx)(l.A,{value:`₹${C.total.toFixed(2)}`,disabled:!0,className:"bg-green-100 border-green-300 text-green-800 font-bold text-lg"})]})]})]}),(0,d.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Information"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,d.jsx)(l.A,{value:y.notes,onChange:a=>H("notes",a.target.value),placeholder:"Additional notes...",className:"w-full"})]})]}),(0,d.jsxs)("div",{className:"flex gap-4 pt-6 border-t border-gray-200 justify-end items-center",children:[(0,d.jsx)(k.A,{type:"button",variant:"secondary",onClick:J,className:"px-8 py-3 rounded-lg",children:"Reset Form"}),(0,d.jsx)(k.A,{type:"submit",disabled:q,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold",children:q?"Creating...":`${"create"===b?"Create":"Update"} Sales Invoice`})]})]})]}),(0,d.jsx)(n.A,{isOpen:u,onClose:()=>v(!1),type:"success",title:"Sales Invoice Created Successfully!",message:w?`Sales invoice ${w.sale?.invoiceNo||"has been created"} successfully with a total amount of ₹${w.sale?.total?.toFixed(2)||C.total.toFixed(2)}.`:"Sales invoice has been created successfully!",confirmText:"View Sales List",onConfirm:()=>{v(!1),x(null),p.push("/dashboard/sales")}})]})}},46859:(a,b,c)=>{c.d(b,{$Q:()=>i,Rf:()=>g,Um:()=>h});let d={dosa:{name:"dosa",rate:25,gstRate:5,unit:"packet"},idli:{name:"idli",rate:20,gstRate:5,unit:"packet"},chapati:{name:"chapati",rate:30,gstRate:5,unit:"packet"},parata:{name:"parata",rate:35,gstRate:5,unit:"packet"},paneer:{name:"paneer",rate:300,gstRate:12,unit:"kg"},"green peas":{name:"green peas",rate:80,gstRate:5,unit:"kg"},Dosa:{name:"Dosa",rate:25,gstRate:5,unit:"packet"},Idli:{name:"Idli",rate:20,gstRate:5,unit:"packet"},Chapati:{name:"Chapati",rate:30,gstRate:5,unit:"packet"},Parata:{name:"Parata",rate:35,gstRate:5,unit:"packet"},Paneer:{name:"Paneer",rate:300,gstRate:12,unit:"kg"},"Green peas":{name:"Green peas",rate:80,gstRate:5,unit:"kg"}};function e(a){if(!a)return null;if(d[a])return d[a];let b=a.toLowerCase();for(let[a,c]of Object.entries(d))if(a.toLowerCase()===b)return c;return null}function f(a,b){return a<0||b<0?0:Math.round(b/100*a*100)/100}function g(a,b,c=null,d=null){let h=null;if(!(h="object"==typeof a&&null!==a?{name:a.name,rate:a.rate,gstRate:a.gstRate,unit:a.unit,hsnCode:a.hsnCode}:e(a)))throw Error(`Invalid product: ${a}`);let i=c||h.rate,j=Math.round(b*i*100)/100,k=f(j,h.gstRate),l=Math.round((j+k)*100)/100;return{product:"string"==typeof a?a:a.name,expiryDate:d||new Date,qty:b,rate:i,taxableValue:j,gst:k,invoiceValue:l,gstRate:h.gstRate,unit:h.unit,hsnCode:h.hsnCode}}function h(a){let b={};return a.forEach(a=>{let c=a.gstRate||0;b[c]||(b[c]={taxableAmount:0,gstAmount:0}),b[c].taxableAmount+=a.taxableValue||0,b[c].gstAmount+=a.gst||0}),Object.keys(b).forEach(a=>{b[a].taxableAmount=Math.round(100*b[a].taxableAmount)/100,b[a].gstAmount=Math.round(100*b[a].gstAmount)/100}),b}function i(a,b,c,d=0){let g=null;if(!(g="object"==typeof a&&null!==a?{name:a.name,rate:a.rate,gstRate:a.gstRate,unit:a.unit,hsnCode:a.hsnCode}:e(a)))throw Error(`Invalid product: ${a}`);let h=Math.round(b*c*100)/100,j=f(h,g.gstRate),k=Math.round((h+j)*100)/100,l=Math.round((k-d)*100)/100;return{taxableValue:h,gst:j,invoiceValue:k,total:l,gstRate:g.gstRate,unit:g.unit,hsnCode:g.hsnCode}}},60230:(a,b,c)=>{var d=c(30);c.o(d,"useParams")&&c.d(b,{useParams:function(){return d.useParams}}),c.o(d,"usePathname")&&c.d(b,{usePathname:function(){return d.usePathname}}),c.o(d,"useRouter")&&c.d(b,{useRouter:function(){return d.useRouter}})},73723:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(55016);c(43161);let e=({type:a="text",label:b,placeholder:c,value:e,onChange:f,onBlur:g,onFocus:h,error:i,success:j,disabled:k=!1,required:l=!1,readOnly:m=!1,className:n="",size:o="md",fullWidth:p=!0,icon:q,iconPosition:r="left",helperText:s,...t})=>{let u=["block w-full border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 text-gray-900 placeholder-gray-500",{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-4 py-3 text-base"}[o],{default:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",error:"border-red-300 focus:border-red-500 focus:ring-red-500",success:"border-green-300 focus:border-green-500 focus:ring-green-500"}[i?"error":j?"success":"default"],k?"bg-gray-50 cursor-not-allowed text-gray-500":"bg-white",p?"w-full":"",q&&"left"===r?"pl-10":"",q&&"right"===r?"pr-10":"",n].filter(Boolean).join(" ");return(0,d.jsxs)("div",{className:`${p?"w-full":""}`,children:[b&&(0,d.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[b,l&&(0,d.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,d.jsxs)("div",{className:"relative",children:[q&&"left"===r&&(0,d.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,d.jsx)("span",{className:"text-gray-400",children:q})}),(0,d.jsx)("input",{type:a,className:u,placeholder:c,value:e,onChange:f,onBlur:g,onFocus:h,disabled:k,required:l,readOnly:m,...t}),q&&"right"===r&&(0,d.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,d.jsx)("span",{className:"text-gray-400",children:q})})]}),i&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i}),j&&(0,d.jsx)("p",{className:"mt-1 text-sm text-green-600",children:j}),s&&!i&&!j&&(0,d.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:s})]})}},95239:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(55016),e=c(43161);let f=({options:a=[],value:b,onChange:c,placeholder:f="Select an option",searchable:g=!1,loading:h=!1,disabled:i=!1,error:j=!1,onSearch:k=null,displayKey:l="label",valueKey:m="value",className:n=""})=>{let[o,p]=(0,e.useState)(!1),[q,r]=(0,e.useState)(""),s=(0,e.useRef)(null);(0,e.useEffect)(()=>{let a=a=>{s.current&&!s.current.contains(a.target)&&(p(!1),r(""))};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let t=g&&q?a.filter(a=>a[l].toLowerCase().includes(q.toLowerCase())):a;return(0,d.jsxs)("div",{className:`relative ${n}`,ref:s,children:[(0,d.jsx)("button",{type:"button",onClick:a=>{a.preventDefault(),a.stopPropagation(),!i&&(p(!o),o||r(""))},disabled:i,className:`
          w-full px-3 py-2.5 text-left border rounded-lg shadow-sm bg-white text-gray-900
          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed
          ${j?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}
          ${o?"ring-2 ring-blue-500 border-blue-500":""}
        `,children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:`${b?"text-gray-900":"text-gray-500"} truncate text-sm flex-1 min-w-0`,children:(()=>{let c=a.find(a=>a[m]===b);return c?c[l]:f})()}),(0,d.jsx)("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),o&&(0,d.jsxs)("div",{className:"absolute z-[9999] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[g&&(0,d.jsx)("div",{className:"p-2 border-b border-gray-200",children:(0,d.jsx)("input",{type:"text",value:q,onChange:a=>{let b=a.target.value;r(b),k&&k(b)},placeholder:"Search...",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0})}),(0,d.jsx)("div",{className:"max-h-48 overflow-y-auto",children:h?(0,d.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Loading..."}):0===t.length?(0,d.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:q?"No options found":"No options available"}):t.map((a,e)=>(0,d.jsx)("button",{type:"button",onClick:b=>((a,b)=>{b.preventDefault(),b.stopPropagation(),c&&"function"==typeof c&&c(a[m]),p(!1),r("")})(a,b),className:`
                    w-full px-3 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none cursor-pointer
                    ${a[m]===b?"bg-blue-50 text-blue-900":"text-gray-900"}
                  `,children:a[l]},a[m]||e))})]})]})}}};