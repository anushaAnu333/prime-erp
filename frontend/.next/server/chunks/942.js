"use strict";exports.id=942,exports.ids=[942],exports.modules={5204:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(55016),e=c(43161);let f=({isOpen:a,onClose:b,title:c,message:f,children:g,type:h="info",showCloseButton:i=!0,onConfirm:j,confirmText:k="OK",cancelText:l="Cancel",showCancelButton:m=!1,size:n="md"})=>{if((0,e.useEffect)(()=>{let c=a=>{"Escape"===a.key&&b()};return a&&(document.addEventListener("keydown",c),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",c),document.body.style.overflow="unset"}},[a,b]),!a)return null;let o=(()=>{switch(h){case"success":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),iconBg:"bg-green-100",iconColor:"text-green-600",titleColor:"text-green-800",borderColor:"border-green-200"};case"error":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),iconBg:"bg-red-100",iconColor:"text-red-600",titleColor:"text-red-800",borderColor:"border-red-200"};case"warning":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),iconBg:"bg-yellow-100",iconColor:"text-yellow-600",titleColor:"text-yellow-800",borderColor:"border-yellow-200"};default:return{icon:(0,d.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),iconBg:"bg-blue-100",iconColor:"text-blue-600",titleColor:"text-blue-800",borderColor:"border-blue-200"}}})(),p=(()=>{switch(n){case"sm":return"max-w-md";case"lg":return"max-w-2xl";default:return"max-w-lg"}})(),q=()=>{b()};return(0,d.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,d.jsxs)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:b}),(0,d.jsx)("div",{className:`relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full ${p}`,children:(0,d.jsxs)("div",{className:`border-l-4 ${o.borderColor}`,children:[(0,d.jsx)("div",{className:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,d.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,d.jsx)("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full sm:mx-0 sm:h-10 sm:w-10 ${o.iconBg}`,children:(0,d.jsx)("div",{className:o.iconColor,children:o.icon})}),(0,d.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[c&&(0,d.jsx)("h3",{className:`text-lg font-medium leading-6 ${o.titleColor} mb-4`,children:c}),g?(0,d.jsx)("div",{className:"mt-2",children:g}):(0,d.jsx)("div",{className:"mt-2",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:f})})]})]})}),!g&&(0,d.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,d.jsx)("button",{type:"button",className:`inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm sm:ml-3 sm:w-auto ${"success"===h?"bg-green-600 hover:bg-green-500":"error"===h?"bg-red-600 hover:bg-red-500":"warning"===h?"bg-yellow-600 hover:bg-yellow-500":"bg-blue-600 hover:bg-blue-500"}`,onClick:()=>{j&&j(),b()},children:k}),m&&(0,d.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:q,children:l}),i&&!m&&(0,d.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:q,children:"Close"})]})]})})]})})}},46859:(a,b,c)=>{c.d(b,{$Q:()=>i,Rf:()=>g,Um:()=>h});let d={dosa:{name:"dosa",rate:25,gstRate:5,unit:"packet"},idli:{name:"idli",rate:20,gstRate:5,unit:"packet"},chapati:{name:"chapati",rate:30,gstRate:5,unit:"packet"},parata:{name:"parata",rate:35,gstRate:5,unit:"packet"},paneer:{name:"paneer",rate:300,gstRate:12,unit:"kg"},"green peas":{name:"green peas",rate:80,gstRate:5,unit:"kg"},Dosa:{name:"Dosa",rate:25,gstRate:5,unit:"packet"},Idli:{name:"Idli",rate:20,gstRate:5,unit:"packet"},Chapati:{name:"Chapati",rate:30,gstRate:5,unit:"packet"},Parata:{name:"Parata",rate:35,gstRate:5,unit:"packet"},Paneer:{name:"Paneer",rate:300,gstRate:12,unit:"kg"},"Green peas":{name:"Green peas",rate:80,gstRate:5,unit:"kg"}};function e(a){if(!a)return null;if(d[a])return d[a];let b=a.toLowerCase();for(let[a,c]of Object.entries(d))if(a.toLowerCase()===b)return c;return null}function f(a,b){return a<0||b<0?0:Math.round(b/100*a*100)/100}function g(a,b,c=null,d=null){let h=null;if(!(h="object"==typeof a&&null!==a?{name:a.name,rate:a.rate,gstRate:a.gstRate,unit:a.unit,hsnCode:a.hsnCode}:e(a)))throw Error(`Invalid product: ${a}`);let i=c||h.rate,j=Math.round(b*i*100)/100,k=f(j,h.gstRate),l=Math.round((j+k)*100)/100;return{product:"string"==typeof a?a:a.name,expiryDate:d||new Date,qty:b,rate:i,taxableValue:j,gst:k,invoiceValue:l,gstRate:h.gstRate,unit:h.unit,hsnCode:h.hsnCode}}function h(a){let b={};return a.forEach(a=>{let c=a.gstRate||0;b[c]||(b[c]={taxableAmount:0,gstAmount:0}),b[c].taxableAmount+=a.taxableValue||0,b[c].gstAmount+=a.gst||0}),Object.keys(b).forEach(a=>{b[a].taxableAmount=Math.round(100*b[a].taxableAmount)/100,b[a].gstAmount=Math.round(100*b[a].gstAmount)/100}),b}function i(a,b,c,d=0){let g=null;if(!(g="object"==typeof a&&null!==a?{name:a.name,rate:a.rate,gstRate:a.gstRate,unit:a.unit,hsnCode:a.hsnCode}:e(a)))throw Error(`Invalid product: ${a}`);let h=Math.round(b*c*100)/100,j=f(h,g.gstRate),k=Math.round((h+j)*100)/100,l=Math.round((k-d)*100)/100;return{taxableValue:h,gst:j,invoiceValue:k,total:l,gstRate:g.gstRate,unit:g.unit,hsnCode:g.hsnCode}}},56135:(a,b,c)=>{c.d(b,{A:()=>o});var d=c(55016),e=c(43161),f=c(26995),g=c(11083),h=c(80656),i=c(46859);let j=null,k=null,l=async()=>{if(j&&k&&Date.now()-k<3e5)return j;try{let a=await fetch("/api/companies");if(a.ok)return j=(await a.json()).companies,k=Date.now(),j}catch(a){console.error("Error fetching companies:",a)}return[{companyCode:"PRIMA-SM",name:"PRIMA Sales & Marketing",address:"123 Business Street, City, State - 123456",gstNumber:"12ABCDE1234F1Z5"},{companyCode:"PRIMA-FT",name:"PRIMA Food Trading",address:"456 Trade Avenue, City, State - 123456",gstNumber:"12ABCDE1234F1Z6"},{companyCode:"PRIMA-EX",name:"PRIMA Export",address:"789 Export Road, City, State - 123456",gstNumber:"12ABCDE1234F1Z7"}]},m=async a=>(await l()).find(b=>b.companyCode===a),n=async()=>{let a=await l();return a[0]||a.find(a=>"PRIMA-SM"===a.companyCode)},o=({sale:a,onClose:b})=>{let[c,j]=(0,e.useState)(!1),[k,l]=(0,e.useState)(null),o=(0,e.useRef)(null);(0,e.useEffect)(()=>{(async()=>{try{let b=a?.companyId||"PRIMA-SM",c=await m(b);l(c)}catch(a){console.error("Error fetching company details:",a),l(await n())}})()},[a]),(0,e.useEffect)(()=>{a&&k&&!c&&(j(!0),setTimeout(()=>{p()},1e3))},[a,k]);let p=async()=>{if(o.current&&a)try{console.log("Starting PDF generation...");let c=await (0,f.default)(o.current,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",width:794,height:o.current.scrollHeight,logging:!0,removeContainer:!1,scrollX:0,scrollY:0,windowWidth:794,windowHeight:o.current.scrollHeight,foreignObjectRendering:!1,imageTimeout:15e3});console.log("Canvas created, generating PDF...");let d=c.toDataURL("image/png"),e=new g.Ay("p","mm","a4"),h=210*c.height/c.width,i=h,k=0;for(e.addImage(d,"PNG",0,k,210,h),i-=295;i>=0;)k=i-h,e.addPage(),e.addImage(d,"PNG",0,k,210,h),i-=295;console.log("PDF created, saving..."),e.save(`Invoice-${a.invoiceNumber}.pdf`),console.log("PDF saved successfully"),j(!1),b&&b()}catch(a){console.error("Error generating PDF:",a),alert("Failed to generate PDF. Please try again."),j(!1),b&&b()}};if(!a)return null;let q=(0,i.Um)(a.items);return(0,d.jsxs)("div",{className:"fixed inset-0 z-50 bg-white flex items-center justify-center",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-lg text-gray-700",children:"Generating PDF..."}),(0,d.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Please wait while we prepare your invoice"})]}),(0,d.jsxs)("div",{ref:o,className:"bg-white p-8 border border-gray-300 text-black",style:{position:"absolute",left:"0",top:"0",width:"794px",fontFamily:"Arial, sans-serif",fontSize:"12px",lineHeight:"1.4",color:"#000000",visibility:"visible",display:"block",zIndex:"9999"},children:[(0,d.jsx)("div",{className:"border-b-2 border-gray-300 pb-6 mb-6",children:(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-3xl font-bold text-black mb-2",children:"TAX INVOICE"}),(0,d.jsxs)("div",{className:"text-sm text-black",children:[(0,d.jsxs)("p",{className:"text-black",children:[(0,d.jsx)("strong",{children:"Invoice No:"})," ",a.invoiceNumber]}),(0,d.jsxs)("p",{className:"text-black",children:[(0,d.jsx)("strong",{children:"Date:"})," ",a.invoiceDate?new Date(a.invoiceDate).toLocaleDateString():"Invalid Date"]})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("h2",{className:"text-xl font-bold text-black mb-2 max-w-xs break-words",children:k?.name||"Prima Sales & Marketing Pvt Ltd"}),(0,d.jsxs)("div",{className:"text-sm text-black",children:[(0,d.jsx)("p",{className:"max-w-xs break-words",children:k?.address||"123 Business Street, City, State - 123456"}),(0,d.jsxs)("p",{className:"text-black",children:["GSTIN: ",k?.gstNumber||"12ABCDE1234F1Z5"]})]})]})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-bold text-black mb-3 border-b border-gray-300 pb-1",children:"Bill To:"}),(0,d.jsxs)("div",{className:"text-sm text-black",children:[(0,d.jsx)("p",{className:"font-semibold text-black",children:a.customerDetails?.shopName}),(0,d.jsx)("p",{className:"text-black",children:a.customerDetails?.name}),(0,d.jsx)("p",{className:"text-black",children:a.customerDetails?.phone}),(0,d.jsx)("p",{className:"whitespace-pre-line text-black max-w-xs break-words",children:a.customerDetails?.address})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-bold text-black mb-3 border-b border-gray-300 pb-1",children:"Invoice Summary:"}),(0,d.jsxs)("div",{className:"text-sm space-y-1 text-black",children:[(0,d.jsxs)("div",{className:"flex justify-between text-black",children:[(0,d.jsx)("span",{className:"text-black",children:"Subtotal:"}),(0,d.jsx)("span",{className:"text-black",children:(0,h.vv)(a.subtotal)})]}),(0,d.jsxs)("div",{className:"flex justify-between text-black",children:[(0,d.jsx)("span",{className:"text-black",children:"Total GST:"}),(0,d.jsx)("span",{className:"text-black",children:(0,h.vv)(a.totalGST)})]}),(0,d.jsxs)("div",{className:"flex justify-between text-black",children:[(0,d.jsx)("span",{className:"text-black",children:"Invoice Value:"}),(0,d.jsx)("span",{className:"text-black",children:(0,h.vv)(a.invoiceValue)})]}),a.discount>0&&(0,d.jsxs)("div",{className:"flex justify-between text-black",children:[(0,d.jsx)("span",{className:"text-black",children:"Discount:"}),(0,d.jsxs)("span",{className:"text-black",children:["-",(0,h.vv)(a.discount)]})]}),(0,d.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t pt-1 text-black",children:[(0,d.jsx)("span",{className:"text-black",children:"Final Amount:"}),(0,d.jsx)("span",{className:"text-black",children:(0,h.vv)(a.finalAmount)})]})]})]})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h3",{className:"text-lg font-bold text-black mb-3 border-b border-gray-300 pb-1",children:"Item Details:"}),(0,d.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"bg-gray-100",children:[(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-bold text-black",children:"S.No"}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-bold text-black",children:"Product Description"}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-center text-sm font-bold text-black",children:"HSN Code"}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-center text-sm font-bold text-black",children:"Qty"}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-center text-sm font-bold text-black",children:"Unit"}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-bold text-black",children:"Rate (₹)"}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-bold text-black",children:"Amount (₹)"}),(0,d.jsxs)("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-bold text-black",children:["GST (",a.items[0]?.gstRate||5,"%)"]}),(0,d.jsx)("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-bold text-black",children:"Total (₹)"})]})}),(0,d.jsx)("tbody",{children:a.items.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-black",children:b+1}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-black max-w-xs break-words",children:a.product}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-center text-black",children:a.hsnCode||"-"}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-center text-black",children:a.qty}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-center text-black",children:a.unit||"-"}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right text-black",children:(0,h.vv)(a.rate)}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right text-black",children:(0,h.vv)(a.taxableValue)}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right text-black",children:(0,h.vv)(a.gst)}),(0,d.jsx)("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right font-medium text-black",children:(0,h.vv)(a.invoiceValue)})]},b))})]})]}),Object.keys(q).length>0&&(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h3",{className:"text-lg font-bold text-black mb-3 border-b border-gray-300 pb-1",children:"GST Breakdown:"}),(0,d.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(q).map(([a,b])=>(0,d.jsxs)("div",{className:"border border-gray-300 p-3",children:[(0,d.jsxs)("div",{className:"text-sm font-bold text-black",children:[a,"% GST"]}),(0,d.jsxs)("div",{className:"text-xs text-black",children:["Taxable: ",(0,h.vv)(b.taxableAmount)]}),(0,d.jsxs)("div",{className:"text-sm font-medium text-black",children:["Tax: ",(0,h.vv)(b.gstAmount)]})]},a))})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h3",{className:"text-lg font-bold text-black mb-3 border-b border-gray-300 pb-1",children:"Terms & Conditions:"}),(0,d.jsxs)("div",{className:"text-sm text-black space-y-1",children:[(0,d.jsx)("p",{className:"text-black",children:"• Payment is due within 30 days of invoice date"}),(0,d.jsx)("p",{className:"text-black",children:"• Goods once sold will not be taken back"}),(0,d.jsx)("p",{className:"text-black",children:"• Interest will be charged on overdue payments"}),(0,d.jsx)("p",{className:"text-black",children:"• Subject to local jurisdiction"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-8 mt-8",children:[(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("div",{className:"border-t-2 border-gray-300 pt-4",children:(0,d.jsx)("p",{className:"text-sm font-bold text-black",children:"Customer Signature"})})}),(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("div",{className:"border-t-2 border-gray-300 pt-4",children:(0,d.jsx)("p",{className:"text-sm font-bold text-black",children:"Authorized Signature"})})})]}),a?.notes&&(0,d.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-300",children:[(0,d.jsx)("h4",{className:"font-bold text-black mb-2",children:"Notes:"}),(0,d.jsx)("p",{className:"text-sm text-black",children:a.notes})]})]})]})}}};