(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{24834:(e,t,a)=>{"use strict";function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function r(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e)}function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}function n(e){return({admin:"Administrator",manager:"Manager",accountant:"Accountant",agent:"Agent"})[e]||e}function c(e){return({admin:"bg-red-100 text-red-800",manager:"bg-blue-100 text-blue-800",accountant:"bg-green-100 text-green-800",agent:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800"}a.d(t,{B9:()=>s,cb:()=>n,cn:()=>l,qP:()=>c,vv:()=>r})},34467:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(73365),r=a(24834);let l=e=>{let{children:t,className:a="",padding:l="p-6",...n}=e,c=(0,r.cn)("bg-white rounded-lg shadow-sm border border-gray-200",l,a);return(0,s.jsx)("div",{className:c,...n,children:t})};l.Header=e=>{let{children:t,className:a="",...l}=e;return(0,s.jsx)("div",{className:(0,r.cn)("border-b border-gray-200 pb-4 mb-4",a),...l,children:t})},l.Title=e=>{let{children:t,className:a="",...l}=e;return(0,s.jsx)("h3",{className:(0,r.cn)("text-lg font-semibold text-gray-900",a),...l,children:t})},l.Content=e=>{let{children:t,className:a="",...l}=e;return(0,s.jsx)("div",{className:(0,r.cn)("",a),...l,children:t})},l.Footer=e=>{let{children:t,className:a="",...l}=e;return(0,s.jsx)("div",{className:(0,r.cn)("border-t border-gray-200 pt-4 mt-4",a),...l,children:t})};let n=l},37170:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let s="http://localhost:3001",r={LOGIN:"".concat(s,"/api/auth/login"),LOGOUT:"".concat(s,"/api/auth/logout"),ME:"".concat(s,"/api/auth/me"),SALES:"".concat(s,"/api/sales"),SALE_BY_ID:e=>"".concat(s,"/api/sales/").concat(e),CUSTOMERS:"".concat(s,"/api/customers"),CUSTOMER_BY_ID:e=>"".concat(s,"/api/customers/").concat(e),PRODUCTS:"".concat(s,"/api/products"),PRODUCT_BY_ID:e=>"".concat(s,"/api/products/").concat(e),DASHBOARD:"".concat(s,"/api/dashboard"),DASHBOARD_STATS:"".concat(s,"/api/dashboard/stats")};class l{getCachedData(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<3e5?t.data:null}setCachedData(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}clearCache(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.cache.delete(e):this.cache.clear()}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={credentials:"include",headers:{"Content-Type":"application/json"}},s={...a,...t,headers:{...a.headers,...t.headers}};try{let t=await fetch(e,s);if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){throw console.error("API request failed:",e),e}}async get(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(t){let t=this.getCachedData(e);if(t)return t}let a=await this.request(e);return t&&this.setCachedData(e,a),a}async post(e,t){return this.request(e,{method:"POST",body:JSON.stringify(t)})}async put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}async login(e){let t=await this.post(r.LOGIN,e);return this.clearCache(),t}async logout(){let e=await this.post(r.LOGOUT);return this.clearCache(),e}async getCurrentUser(){return this.get(r.ME,!1)}async getSales(){return this.get(r.SALES)}async getSale(e){return this.get(r.SALE_BY_ID(e))}async createSale(e){let t=await this.post(r.SALES,e);return this.clearCache(r.SALES),t}async updateSale(e,t){let a=await this.put(r.SALE_BY_ID(e),t);return this.clearCache(r.SALES),this.clearCache(r.SALE_BY_ID(e)),a}async deleteSale(e){let t=await this.delete(r.SALE_BY_ID(e));return this.clearCache(r.SALES),this.clearCache(r.SALE_BY_ID(e)),t}async getCustomers(){return this.get(r.CUSTOMERS)}async getCustomer(e){return this.get(r.CUSTOMER_BY_ID(e))}async createCustomer(e){let t=await this.post(r.CUSTOMERS,e);return this.clearCache(r.CUSTOMERS),t}async updateCustomer(e,t){let a=await this.put(r.CUSTOMER_BY_ID(e),t);return this.clearCache(r.CUSTOMERS),this.clearCache(r.CUSTOMER_BY_ID(e)),a}async deleteCustomer(e){let t=await this.delete(r.CUSTOMER_BY_ID(e));return this.clearCache(r.CUSTOMERS),this.clearCache(r.CUSTOMER_BY_ID(e)),t}async getProducts(){return this.get(r.PRODUCTS)}async getProduct(e){return this.get(r.PRODUCT_BY_ID(e))}async createProduct(e){let t=await this.post(r.PRODUCTS,e);return this.clearCache(r.PRODUCTS),t}async updateProduct(e,t){let a=await this.put(r.PRODUCT_BY_ID(e),t);return this.clearCache(r.PRODUCTS),this.clearCache(r.PRODUCT_BY_ID(e)),a}async deleteProduct(e){let t=await this.delete(r.PRODUCT_BY_ID(e));return this.clearCache(r.PRODUCTS),this.clearCache(r.PRODUCT_BY_ID(e)),t}async getDashboardStats(){return this.get(r.DASHBOARD_STATS)}async getDashboard(){return this.get(r.DASHBOARD)}constructor(){this.baseURL="http://localhost:3001",this.cache=new Map}}let n=new l},38623:(e,t,a)=>{"use strict";a.d(t,{As:()=>n,e6:()=>c,jL:()=>r});var s=a(29183);let r=()=>(0,s.wA)(),l=s.d4,n=()=>l(e=>e.auth),c=()=>l(e=>e.dashboard.data)},45191:(e,t,a)=>{Promise.resolve().then(a.bind(a,65396))},65396:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var s=a(73365),r=a(1521),l=a(1702),n=a(38623),c=a(91775),i=a(34467),d=a(90191),o=a(83632),u=a(40869),h=a(82760),m=a(8913),g=a(17634),x=a(34703),p=a(5921),y=a(95109),b=a(13036),v=a(73266),j=a(98137);let f=e=>{var t,a,l,c,f,S;let{user:C}=e,N=(0,n.jL)(),D=(0,n.e6)(),{loading:w,error:A}=(0,n.e6)();(0,r.useEffect)(()=>{N((0,d.Hb)())},[N]);let T=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return w?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)(i.A,{className:"animate-pulse p-6",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),(0,s.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]},t))})]}):A?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"})}),(0,s.jsx)(i.A,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Error Loading Dashboard Data"}),(0,s.jsx)("div",{className:"text-gray-600 mb-4",children:A}),(0,s.jsx)("button",{onClick:()=>N((0,d.Hb)()),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry"})]})})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(i.A,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sales vs Purchases Trend"}),D.salesTrend&&D.salesTrend.length>0?(0,s.jsx)(o.u,{width:"100%",height:250,children:(0,s.jsxs)(u.b,{data:D.salesTrend,children:[(0,s.jsx)(h.W,{dataKey:"month",fontSize:10,tick:{fontSize:10}}),(0,s.jsx)(m.h,{fontSize:10,tick:{fontSize:10}}),(0,s.jsx)(g.m,{formatter:e=>T(e),contentStyle:{fontSize:10}}),(0,s.jsx)(x.N,{type:"monotone",dataKey:"sales",stroke:"#3B82F6",strokeWidth:2,name:"Sales"}),(0,s.jsx)(x.N,{type:"monotone",dataKey:"purchases",stroke:"#1E40AF",strokeWidth:2,name:"Purchases"})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-[250px] text-gray-500",children:"No trend data available"})]}),(0,s.jsxs)(i.A,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Products"}),D.topProducts&&D.topProducts.length>0?(0,s.jsxs)("div",{className:"flex items-center justify-center h-[250px]",children:[(0,s.jsx)(o.u,{width:250,height:250,children:(0,s.jsxs)(p.r,{children:[(0,s.jsx)(y.F,{data:D.topProducts,cx:125,cy:125,innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"revenue",children:D.topProducts.map((e,t)=>(0,s.jsx)(b.f,{fill:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"][t%5]},"cell-".concat(t)))}),(0,s.jsx)(g.m,{formatter:e=>T(e),contentStyle:{fontSize:10}})]})}),(0,s.jsx)("div",{className:"ml-6",children:(0,s.jsx)("div",{className:"space-y-2",children:D.topProducts.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"][t%5]}}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:e.name}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 ml-2",children:T(e.revenue)})]},t))})})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-[250px] text-gray-500",children:"No product data available"})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(i.A,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Revenue Trend"}),D.salesTrend&&D.salesTrend.length>0?(0,s.jsx)("div",{children:(0,s.jsx)(o.u,{width:"100%",height:250,children:(0,s.jsxs)(v.E,{data:D.salesTrend,children:[(0,s.jsx)(h.W,{dataKey:"month",fontSize:10,tick:{fontSize:10}}),(0,s.jsx)(m.h,{type:"number",fontSize:10,tick:{fontSize:10},tickFormatter:e=>"₹".concat((e/1e3).toFixed(0),"K")}),(0,s.jsx)(g.m,{formatter:e=>"₹".concat(e.toLocaleString()),contentStyle:{fontSize:10}}),(0,s.jsx)(j.y,{dataKey:"sales",fill:"#10B981",radius:[2,2,0,0],barSize:20})]})})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-[250px] text-gray-500",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-medium mb-2",children:"No revenue data available"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Start creating sales to see trends"})]})})]}),(0,s.jsxs)(i.A,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Business Overview"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 h-[250px]",children:[(0,s.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:(null==(t=D.overview)?void 0:t.totalCustomers)||0}),(0,s.jsx)("div",{className:"text-sm font-medium text-blue-800",children:"Total Customers"})]}),(0,s.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg border border-green-200",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(null==(a=D.overview)?void 0:a.totalVendors)||0}),(0,s.jsx)("div",{className:"text-sm font-medium text-green-800",children:"Total Vendors"})]}),(0,s.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg border border-purple-200",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600 mb-1 truncate",children:"number"==typeof(null==(l=D.overview)?void 0:l.totalSales)?Math.round(D.overview.totalSales).toLocaleString():(null==(c=D.overview)?void 0:c.totalSales)||0}),(0,s.jsx)("div",{className:"text-sm font-medium text-purple-800",children:"Total Sales"})]}),(0,s.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg border border-orange-200",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-600 mb-1 truncate",children:"number"==typeof(null==(f=D.overview)?void 0:f.totalPurchases)?Math.round(D.overview.totalPurchases).toLocaleString():(null==(S=D.overview)?void 0:S.totalPurchases)||0}),(0,s.jsx)("div",{className:"text-sm font-medium text-orange-800",children:"Total Purchases"})]})]})]})]})]})]})};function S(){let e=(0,l.useRouter)(),t=(0,n.jL)(),{user:a,isAuthenticated:i,loading:d}=(0,n.As)();return((0,r.useEffect)(()=>{let a=async()=>{try{await t((0,c.HW)()).unwrap()}catch(t){console.error("Auth check failed:",t),e.push("/login")}};i||d||a()},[t,i,d,e]),d)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):i&&a?(0,s.jsx)(f,{user:a}):null}},90191:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>u,Hb:()=>l});var s=a(28276),r=a(37170);let l=(0,s.zD)("dashboard/fetchData",async(e,t)=>{let{rejectWithValue:a}=t;try{return await r.A.getDashboard()}catch(e){return a(e.message)}}),n=(0,s.zD)("dashboard/fetchStats",async(e,t)=>{let{rejectWithValue:a}=t;try{return await r.A.getDashboardStats()}catch(e){return a(e.message)}}),c={data:{overview:{totalSales:0,totalPurchases:0,totalCustomers:0,totalVendors:0,totalProducts:0,totalRevenue:0,totalExpenses:0,profit:0},recentActivity:{sales:[],purchases:[]},monthlyStats:{sales:[]},salesTrend:[],shopsPerformance:[],invoicesOverview:[],topProducts:[]},stats:{sales:{pending:0,completed:0,total:0},purchases:{pending:0,completed:0,total:0},topCustomers:[],topProducts:[]},loading:!1,error:null,lastFetched:null},i=(0,s.Z0)({name:"dashboard",initialState:c,reducers:{clearError:e=>{e.error=null},clearDashboardData:e=>{e.data=c.data,e.stats=c.stats,e.lastFetched=null}},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,t)=>{e.loading=!1,e.data={...e.data,...t.payload},e.lastFetched=new Date().toISOString(),e.error=null}).addCase(l.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.stats=t.payload,e.lastFetched=new Date().toISOString(),e.error=null}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}),{clearError:d,clearDashboardData:o}=i.actions,u=i.reducer},91775:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>u,HW:()=>c,Lx:()=>l});var s=a(28276),r=a(37170);let l=(0,s.zD)("auth/login",async(e,t)=>{let{rejectWithValue:a}=t;try{return await r.A.login(e)}catch(e){return a(e.message)}}),n=(0,s.zD)("auth/logout",async(e,t)=>{let{rejectWithValue:a}=t;try{return await r.A.logout()}catch(e){return a(e.message)}}),c=(0,s.zD)("auth/getCurrentUser",async(e,t)=>{let{rejectWithValue:a}=t;try{return await r.A.getCurrentUser()}catch(e){return a(e.message)}}),i=(0,s.Z0)({name:"auth",initialState:{user:null,isAuthenticated:!1,loading:!1,error:null},reducers:{clearError:e=>{e.error=null},setUser:(e,t)=>{e.user=t.payload,e.isAuthenticated=!!t.payload}},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,t)=>{e.loading=!1,e.user=t.payload.user,e.isAuthenticated=!0,e.error=null}).addCase(l.rejected,(e,t)=>{e.loading=!1,e.error=t.payload,e.user=null,e.isAuthenticated=!1}).addCase(n.pending,e=>{e.loading=!0}).addCase(n.fulfilled,e=>{e.loading=!1,e.user=null,e.isAuthenticated=!1,e.error=null}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(c.pending,e=>{e.loading=!0}).addCase(c.fulfilled,(e,t)=>{e.loading=!1,e.user=t.payload.user,e.isAuthenticated=!0,e.error=null}).addCase(c.rejected,(e,t)=>{e.loading=!1,e.user=null,e.isAuthenticated=!1,e.error=t.payload})}}),{clearError:d,setUser:o}=i.actions,u=i.reducer}},e=>{e.O(0,[96,358],()=>e(e.s=45191)),_N_E=e.O()}]);