(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{21071:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(73365);s(1521);let r=e=>{let{type:t="text",label:s,placeholder:r,value:l,onChange:n,onBlur:o,onFocus:c,error:d,success:i,disabled:u=!1,required:x=!1,readOnly:m=!1,className:h="",size:g="md",fullWidth:p=!0,icon:b,iconPosition:f="left",helperText:v,...y}=e,j=["block w-full border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 text-gray-900 placeholder-gray-500",{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-4 py-3 text-base"}[g],{default:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",error:"border-red-300 focus:border-red-500 focus:ring-red-500",success:"border-green-300 focus:border-green-500 focus:ring-green-500"}[d?"error":i?"success":"default"],u?"bg-gray-50 cursor-not-allowed text-gray-500":"bg-white",p?"w-full":"",b&&"left"===f?"pl-10":"",b&&"right"===f?"pr-10":"",h].filter(Boolean).join(" ");return(0,a.jsxs)("div",{className:"".concat(p?"w-full":""),children:[s&&(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s,x&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[b&&"left"===f&&(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-400",children:b})}),(0,a.jsx)("input",{type:t,className:j,placeholder:r,value:l,onChange:n,onBlur:o,onFocus:c,disabled:u,required:x,readOnly:m,...y}),b&&"right"===f&&(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-400",children:b})})]}),d&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d}),i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-green-600",children:i}),v&&!d&&!i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:v})]})}},33097:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var a=s(73365),r=s(1521),l=s(41633),n=s(21071),o=s(57353),c=s(34467),d=s(85299),i=s(18197),u=s.n(i);let x=e=>{let{dateFrom:t,dateTo:s,onDateChange:o}=e,[c,d]=(0,r.useState)(!1),[i,u]=(0,r.useState)(t),[x,m]=(0,r.useState)(s),h=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{u(t),m(s)},[t,s]),(0,a.jsxs)("div",{className:"relative",ref:h,children:[(0,a.jsx)("button",{type:"button",onClick:()=>d(!c),className:"w-full px-3 py-2.5 text-left border border-gray-300 rounded-lg shadow-sm bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"".concat(t||s?"text-gray-900":"text-gray-500"," text-sm truncate"),children:t&&s?"".concat(t," to ").concat(s):t?"From ".concat(t):s?"To ".concat(s):"Date Range"}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform ".concat(c?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),c&&(0,a.jsx)("div",{className:"absolute z-50 w-80 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),(0,a.jsx)(n.A,{type:"date",value:i,onChange:e=>u(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),(0,a.jsx)(n.A,{type:"date",value:x,onChange:e=>m(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,a.jsx)(l.A,{type:"button",onClick:()=>{o("dateFrom",i),o("dateTo",x),d(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 text-sm",children:"Apply"}),(0,a.jsx)(l.A,{type:"button",onClick:()=>{u(""),m(""),o("dateFrom",""),o("dateTo",""),d(!1)},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 text-sm",children:"Clear"})]})]})})]})};function m(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)([]),[i,m]=(0,r.useState)([{value:"",label:"All Companies"},{value:"PRIMA-SM",label:"PRIMA Sales & Marketing"},{value:"PRIMA-FT",label:"PRIMA Food Trading"},{value:"PRIMA-EX",label:"PRIMA Export"}]),[h,g]=(0,r.useState)({vendor:"",company:"",dateFrom:"",dateTo:"",type:"Purchase"}),[p,b]=(0,r.useState)({page:1,total:0,totalPages:0}),[f,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{y(),j()},[h,p.page]);let y=async()=>{v(!0);try{let e=new URLSearchParams({page:p.page.toString(),limit:"20",type:h.type,...h.vendor&&{vendor:h.vendor},...h.company&&{company:h.company},...h.dateFrom&&{dateFrom:h.dateFrom},...h.dateTo&&{dateTo:h.dateTo}}),s=await fetch("/api/purchases?".concat(e));if(s.ok){let e=await s.json();t(e.purchases),b(t=>({...t,total:e.total,totalPages:e.totalPages}))}}catch(e){console.error("Error fetching purchases:",e)}finally{v(!1)}},j=async()=>{try{let e=await fetch("/api/vendors");if(e.ok){let t=await e.json();n([{value:"",label:"All Vendors"},...(t.vendors||[]).map(e=>({value:e.vendorName,label:e.vendorName}))])}}catch(e){console.error("Error fetching vendors:",e)}},N=(e,t)=>{g(s=>({...s,[e]:t})),b(e=>({...e,page:1}))},w=e=>{b(t=>({...t,page:e}))},P=e=>new Date(e).toLocaleDateString("en-IN"),k=[{key:"purchaseNumber",header:"Purchase Return"===h.type?"Return No":"Purchase No",render:(e,t)=>(0,a.jsx)(u(),{href:"/dashboard/purchases/".concat(t._id),className:"text-blue-600 hover:text-blue-800 font-medium",children:e})},{key:"date",header:"Date",render:e=>P(e)},{key:"vendorName",header:"Vendor",render:(e,t)=>"Purchase Return"===h.type&&t.originalPurchase?(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:e}),(0,a.jsxs)("div",{className:"text-gray-500 text-xs",children:["Against: ",t.originalPurchase.purchaseNumber]})]}):e},{key:"supplierInvoiceNumber",header:"Supplier Invoice",render:(e,t)=>"Purchase Return"===h.type?t.originalPurchase?(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium text-gray-600",children:"Original Purchase"}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:P(t.originalPurchase.date)})]}):"N/A":t.supplierInvoiceNumber?(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:t.supplierInvoiceNumber}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:t.supplierInvoiceDate?P(t.supplierInvoiceDate):""})]}):"N/A"},{key:"items",header:"Products",render:(e,t)=>{if(e&&e.length>0)if(1===e.length)return(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:e[0].product}),(0,a.jsxs)("div",{className:"text-gray-500 text-xs",children:["Qty: ",e[0].qty," \xd7 â‚¹",e[0].rate]})]});else return(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.length," Products"]}),(0,a.jsxs)("div",{className:"text-gray-500 text-xs",children:[e.slice(0,2).map(e=>"".concat(e.product," (").concat(e.qty,")")).join(", "),e.length>2&&" +".concat(e.length-2," more")]})]});return"N/A"}},{key:"total",header:"Amount",render:e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e)},{key:"status",header:"Status",render:(e,t)=>{let s=(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({Pending:"bg-yellow-100 text-yellow-800",Received:"bg-green-100 text-green-800",Cancelled:"bg-red-100 text-red-800",Returned:"bg-blue-100 text-blue-800"}[e]||"bg-gray-100 text-gray-800"),children:e}),r=t.hasReturns||!1;return(0,a.jsxs)("div",{className:"space-y-1",children:[s,r&&(0,a.jsx)("div",{className:"text-xs text-red-600 font-medium",children:"Has Returns"})]})}},{key:"actions",header:"Actions",render:(e,t)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u(),{href:"/dashboard/purchases/".concat(t._id),children:(0,a.jsx)(l.A,{size:"sm",variant:"outline",children:"View"})}),(0,a.jsx)(u(),{href:"/dashboard/purchases/edit/".concat(t._id),children:(0,a.jsx)(l.A,{size:"sm",variant:"outline",children:"Edit"})})]})}];return(0,a.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,a.jsxs)(c.A,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Purchase"===h.type?"Purchase Invoices":"Purchase Returns"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u(),{href:"/dashboard/purchases/create",children:(0,a.jsx)(l.A,{className:"bg-blue-600 hover:bg-blue-700",children:"Create Purchase Invoice"})}),(0,a.jsx)(u(),{href:"/dashboard/purchases/returns/create",children:(0,a.jsx)(l.A,{className:"bg-red-600 hover:bg-red-700",children:"Create Purchase Return"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-6",children:[(0,a.jsx)(o.A,{placeholder:"Select Vendor",options:s,value:h.vendor,onChange:e=>N("vendor",e)}),(0,a.jsx)(o.A,{placeholder:"Select Company",options:i,value:h.company,onChange:e=>N("company",e)}),(0,a.jsx)(x,{dateFrom:h.dateFrom,dateTo:h.dateTo,onDateChange:(e,t)=>N(e,t)}),(0,a.jsx)(o.A,{options:[{value:"Purchase",label:"Purchases"},{value:"Purchase Return",label:"Returns"}],value:h.type,onChange:e=>N("type",e)})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)(d.A,{data:e,columns:k,loading:f,emptyMessage:"No purchases found"})}),p.totalPages>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing page ",p.page," of ",p.totalPages," (",p.total," total)"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.A,{variant:"outline",disabled:1===p.page,onClick:()=>w(p.page-1),children:"Previous"}),(0,a.jsx)(l.A,{variant:"outline",disabled:p.page===p.totalPages,onClick:()=>w(p.page+1),children:"Next"})]})]})]})})}},57336:(e,t,s)=>{Promise.resolve().then(s.bind(s,33097))},57353:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(73365),r=s(1521);let l=e=>{let{options:t=[],value:s,onChange:l,placeholder:n="Select an option",searchable:o=!1,loading:c=!1,disabled:d=!1,error:i=!1,onSearch:u=null,displayKey:x="label",valueKey:m="value",className:h=""}=e,[g,p]=(0,r.useState)(!1),[b,f]=(0,r.useState)(""),v=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{v.current&&!v.current.contains(e.target)&&(p(!1),f(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let y=o&&b?t.filter(e=>e[x].toLowerCase().includes(b.toLowerCase())):t;return(0,a.jsxs)("div",{className:"relative ".concat(h),ref:v,children:[(0,a.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),!d&&(p(!g),g||f(""))},disabled:d,className:"\n          w-full px-3 py-2.5 text-left border rounded-lg shadow-sm bg-white text-gray-900\n          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed\n          ".concat(i?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300","\n          ").concat(g?"ring-2 ring-blue-500 border-blue-500":"","\n        "),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"".concat(s?"text-gray-900":"text-gray-500"," truncate text-sm flex-1 min-w-0"),children:(()=>{let e=t.find(e=>e[m]===s);return e?e[x]:n})()}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform ".concat(g?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),g&&(0,a.jsxs)("div",{className:"absolute z-[9999] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[o&&(0,a.jsx)("div",{className:"p-2 border-b border-gray-200",children:(0,a.jsx)("input",{type:"text",value:b,onChange:e=>{let t=e.target.value;f(t),u&&u(t)},placeholder:"Search...",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0})}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto",children:c?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Loading..."}):0===y.length?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:b?"No options found":"No options available"}):y.map((e,t)=>(0,a.jsx)("button",{type:"button",onClick:t=>((e,t)=>{t.preventDefault(),t.stopPropagation(),l&&"function"==typeof l&&l(e[m]),p(!1),f("")})(e,t),className:"\n                    w-full px-3 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none cursor-pointer\n                    ".concat(e[m]===s?"bg-blue-50 text-blue-900":"text-gray-900","\n                  "),children:e[x]},e[m]||t))})]})]})}}},e=>{e.O(0,[96,29,358],()=>e(e.s=57336)),_N_E=e.O()}]);