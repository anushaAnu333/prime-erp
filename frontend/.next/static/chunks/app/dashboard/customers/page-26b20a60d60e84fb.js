(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[819],{21071:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(73365);s(1521);let r=e=>{let{type:t="text",label:s,placeholder:r,value:n,onChange:l,onBlur:o,onFocus:c,error:d,success:i,disabled:u=!1,required:m=!1,readOnly:x=!1,className:h="",size:g="md",fullWidth:p=!0,icon:f,iconPosition:b="left",helperText:y,...j}=e,N=["block w-full border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 text-gray-900 placeholder-gray-500",{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-4 py-3 text-base"}[g],{default:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",error:"border-red-300 focus:border-red-500 focus:ring-red-500",success:"border-green-300 focus:border-green-500 focus:ring-green-500"}[d?"error":i?"success":"default"],u?"bg-gray-50 cursor-not-allowed text-gray-500":"bg-white",p?"w-full":"",f&&"left"===b?"pl-10":"",f&&"right"===b?"pr-10":"",h].filter(Boolean).join(" ");return(0,a.jsxs)("div",{className:"".concat(p?"w-full":""),children:[s&&(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s,m&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[f&&"left"===b&&(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-400",children:f})}),(0,a.jsx)("input",{type:t,className:N,placeholder:r,value:n,onChange:l,onBlur:o,onFocus:c,disabled:u,required:m,readOnly:x,...j}),f&&"right"===b&&(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-400",children:f})})]}),d&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d}),i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-green-600",children:i}),y&&!d&&!i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:y})]})}},43535:(e,t,s)=>{Promise.resolve().then(s.bind(s,61557))},57353:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(73365),r=s(1521);let n=e=>{let{options:t=[],value:s,onChange:n,placeholder:l="Select an option",searchable:o=!1,loading:c=!1,disabled:d=!1,error:i=!1,onSearch:u=null,displayKey:m="label",valueKey:x="value",className:h=""}=e,[g,p]=(0,r.useState)(!1),[f,b]=(0,r.useState)(""),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&(p(!1),b(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let j=o&&f?t.filter(e=>e[m].toLowerCase().includes(f.toLowerCase())):t;return(0,a.jsxs)("div",{className:"relative ".concat(h),ref:y,children:[(0,a.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),!d&&(p(!g),g||b(""))},disabled:d,className:"\n          w-full px-3 py-2.5 text-left border rounded-lg shadow-sm bg-white text-gray-900\n          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed\n          ".concat(i?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300","\n          ").concat(g?"ring-2 ring-blue-500 border-blue-500":"","\n        "),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"".concat(s?"text-gray-900":"text-gray-500"," truncate text-sm flex-1 min-w-0"),children:(()=>{let e=t.find(e=>e[x]===s);return e?e[m]:l})()}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform ".concat(g?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),g&&(0,a.jsxs)("div",{className:"absolute z-[9999] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[o&&(0,a.jsx)("div",{className:"p-2 border-b border-gray-200",children:(0,a.jsx)("input",{type:"text",value:f,onChange:e=>{let t=e.target.value;b(t),u&&u(t)},placeholder:"Search...",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0})}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto",children:c?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Loading..."}):0===j.length?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:f?"No options found":"No options available"}):j.map((e,t)=>(0,a.jsx)("button",{type:"button",onClick:t=>((e,t)=>{t.preventDefault(),t.stopPropagation(),n&&"function"==typeof n&&n(e[x]),p(!1),b("")})(e,t),className:"\n                    w-full px-3 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none cursor-pointer\n                    ".concat(e[x]===s?"bg-blue-50 text-blue-900":"text-gray-900","\n                  "),children:e[m]},e[x]||t))})]})]})}},61557:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(73365),r=s(1521),n=s(41633),l=s(21071),o=s(57353),c=s(34467),d=s(85299),i=s(18197),u=s.n(i);function m(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[h,g]=(0,r.useState)({search:"",company:""}),[p,f]=(0,r.useState)({page:1,total:0,totalPages:0}),[b,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{j(),N()},[h,p.page]);let j=async()=>{y(!0);try{let e=new URLSearchParams({page:p.page.toString(),limit:"20",...h.search&&{search:h.search},...h.company&&{company:h.company}}),s=await fetch("/api/customers?".concat(e));if(s.ok){let e=await s.json();t(e.customers),f(t=>({...t,total:e.total,totalPages:e.totalPages}))}}catch(e){console.error("Error fetching customers:",e)}finally{y(!1)}},N=async()=>{try{let e=await fetch("/api/companies");if(e.ok){let t=(await e.json()).companies||[];console.log("Fetched companies for list:",t),i(t),x([{value:"",label:"All Companies"},...t.map(e=>({value:e.companyCode,label:e.name}))])}}catch(e){console.error("Error fetching companies:",e)}},v=(e,t)=>{g(s=>({...s,[e]:t})),f(e=>({...e,page:1}))},w=e=>{f(t=>({...t,page:e}))},k=[{key:"customerCode",header:"Code",className:"w-20",render:(e,t)=>(0,a.jsx)(u(),{href:"/dashboard/customers/".concat(t._id),className:"text-blue-600 hover:text-blue-800 font-medium text-sm",children:e})},{key:"shopName",header:"Shop",className:"w-32",render:(e,t)=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium truncate",children:e}),(0,a.jsx)("div",{className:"text-gray-500 text-xs truncate",children:t.name})]})},{key:"phoneNumber",header:"Phone",className:"w-28",render:e=>(0,a.jsx)("span",{className:"text-sm font-medium",children:e})},{key:"address",header:"Address",render:e=>(0,a.jsx)("span",{className:"text-sm text-gray-600 max-w-32 truncate block",children:e})},{key:"currentBalance",header:"Balance",render:e=>(0,a.jsx)("span",{className:"text-sm font-medium ".concat(e>0?"text-red-600":"text-green-600"),children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e)})},{key:"companyId",header:"Company",render:(e,t)=>{let r=s.find(t=>t.companyCode===e);return(0,a.jsx)("span",{className:"text-sm text-gray-600 truncate",children:r?r.name:"Not Assigned"})}},{key:"createdAt",header:"Created",render:e=>new Date(e).toLocaleDateString("en-IN")},{key:"actions",header:"Actions",render:(e,t)=>(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(u(),{href:"/dashboard/customers/".concat(t._id),children:(0,a.jsx)(n.A,{size:"sm",variant:"outline",className:"text-xs px-2 py-1",children:"View"})}),(0,a.jsx)(u(),{href:"/dashboard/customers/edit/".concat(t._id),children:(0,a.jsx)(n.A,{size:"sm",variant:"outline",className:"text-xs px-2 py-1",children:"Edit"})})]})}];return(0,a.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,a.jsxs)(c.A,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Customers"}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(u(),{href:"/dashboard/customers/create",children:(0,a.jsx)(n.A,{className:"bg-blue-600 hover:bg-blue-700",children:"Add Customer"})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,a.jsx)(l.A,{type:"text",placeholder:"Search by name, shop name, or phone",value:h.search,onChange:e=>v("search",e.target.value)}),(0,a.jsx)(o.A,{options:m,value:h.company,onChange:e=>v("company",e),placeholder:"Filter by Company"})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)(d.A,{data:e,columns:k,loading:b,emptyMessage:"No customers found"})}),p.totalPages>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing page ",p.page," of ",p.totalPages," (",p.total," total)"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.A,{variant:"outline",disabled:1===p.page,onClick:()=>w(p.page-1),children:"Previous"}),(0,a.jsx)(n.A,{variant:"outline",disabled:p.page===p.totalPages,onClick:()=>w(p.page+1),children:"Next"})]})]})]})})}function x(){return(0,a.jsx)(m,{})}}},e=>{e.O(0,[96,29,358],()=>e(e.s=43535)),_N_E=e.O()}]);