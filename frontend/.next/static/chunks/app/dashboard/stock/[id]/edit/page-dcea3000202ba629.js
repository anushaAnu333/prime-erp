(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[723],{11145:(e,t,s)=>{Promise.resolve().then(s.bind(s,78749))},21071:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(73365);s(1521);let r=e=>{let{type:t="text",label:s,placeholder:r,value:n,onChange:l,onBlur:o,onFocus:c,error:i,success:d,disabled:m=!1,required:u=!1,readOnly:x=!1,className:g="",size:b="md",fullWidth:h=!0,icon:p,iconPosition:f="left",helperText:y,...j}=e,N=["block w-full border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 text-gray-900 placeholder-gray-500",{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-4 py-3 text-base"}[b],{default:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",error:"border-red-300 focus:border-red-500 focus:ring-red-500",success:"border-green-300 focus:border-green-500 focus:ring-green-500"}[i?"error":d?"success":"default"],m?"bg-gray-50 cursor-not-allowed text-gray-500":"bg-white",h?"w-full":"",p&&"left"===f?"pl-10":"",p&&"right"===f?"pr-10":"",g].filter(Boolean).join(" ");return(0,a.jsxs)("div",{className:"".concat(h?"w-full":""),children:[s&&(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s,u&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[p&&"left"===f&&(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-400",children:p})}),(0,a.jsx)("input",{type:t,className:N,placeholder:r,value:n,onChange:l,onBlur:o,onFocus:c,disabled:m,required:u,readOnly:x,...j}),p&&"right"===f&&(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-400",children:p})})]}),i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i}),d&&(0,a.jsx)("p",{className:"mt-1 text-sm text-green-600",children:d}),y&&!i&&!d&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:y})]})}},24834:(e,t,s)=>{"use strict";function a(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function r(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e)}function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}function l(e){return({admin:"Administrator",manager:"Manager",accountant:"Accountant",agent:"Agent"})[e]||e}function o(e){return({admin:"bg-red-100 text-red-800",manager:"bg-blue-100 text-blue-800",accountant:"bg-green-100 text-green-800",agent:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800"}s.d(t,{B9:()=>a,cb:()=>l,cn:()=>n,qP:()=>o,vv:()=>r})},34467:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(73365),r=s(24834);let n=e=>{let{children:t,className:s="",padding:n="p-6",...l}=e,o=(0,r.cn)("bg-white rounded-lg shadow-sm border border-gray-200",n,s);return(0,a.jsx)("div",{className:o,...l,children:t})};n.Header=e=>{let{children:t,className:s="",...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)("border-b border-gray-200 pb-4 mb-4",s),...n,children:t})},n.Title=e=>{let{children:t,className:s="",...n}=e;return(0,a.jsx)("h3",{className:(0,r.cn)("text-lg font-semibold text-gray-900",s),...n,children:t})},n.Content=e=>{let{children:t,className:s="",...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)("",s),...n,children:t})},n.Footer=e=>{let{children:t,className:s="",...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)("border-t border-gray-200 pt-4 mt-4",s),...n,children:t})};let l=n},41633:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(73365);s(1521);var r=s(18197),n=s.n(r);let l=e=>{let{children:t,variant:s="primary",size:r="md",disabled:l=!1,loading:o=!1,href:c,onClick:i,type:d="button",className:m="",icon:u,iconPosition:x="left",fullWidth:g=!1,...b}=e,h=["inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",secondary:"bg-gray-600 hover:bg-gray-700 text-white focus:ring-gray-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",info:"bg-blue-500 hover:bg-blue-600 text-white focus:ring-blue-400",outline:"border border-gray-300 bg-white hover:bg-gray-50 text-gray-700 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 text-gray-700 focus:ring-gray-500"}[s],{xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"}[r],g?"w-full":"",m].filter(Boolean).join(" "),p=(0,a.jsxs)(a.Fragment,{children:[o&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!o&&u&&"left"===x&&(0,a.jsx)("span",{className:"mr-2",children:u}),t,!o&&u&&"right"===x&&(0,a.jsx)("span",{className:"ml-2",children:u})]});return c?(0,a.jsx)(n(),{href:c,className:h,...b,children:p}):(0,a.jsx)("button",{type:d,className:h,disabled:l||o,onClick:i,...b,children:p})}},57353:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(73365),r=s(1521);let n=e=>{let{options:t=[],value:s,onChange:n,placeholder:l="Select an option",searchable:o=!1,loading:c=!1,disabled:i=!1,error:d=!1,onSearch:m=null,displayKey:u="label",valueKey:x="value",className:g=""}=e,[b,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)(""),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&(h(!1),f(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let j=o&&p?t.filter(e=>e[u].toLowerCase().includes(p.toLowerCase())):t;return(0,a.jsxs)("div",{className:"relative ".concat(g),ref:y,children:[(0,a.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),!i&&(h(!b),b||f(""))},disabled:i,className:"\n          w-full px-3 py-2.5 text-left border rounded-lg shadow-sm bg-white text-gray-900\n          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed\n          ".concat(d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300","\n          ").concat(b?"ring-2 ring-blue-500 border-blue-500":"","\n        "),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"".concat(s?"text-gray-900":"text-gray-500"," truncate text-sm flex-1 min-w-0"),children:(()=>{let e=t.find(e=>e[x]===s);return e?e[u]:l})()}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform ".concat(b?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),b&&(0,a.jsxs)("div",{className:"absolute z-[9999] w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[o&&(0,a.jsx)("div",{className:"p-2 border-b border-gray-200",children:(0,a.jsx)("input",{type:"text",value:p,onChange:e=>{let t=e.target.value;f(t),m&&m(t)},placeholder:"Search...",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0})}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto",children:c?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Loading..."}):0===j.length?(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:p?"No options found":"No options available"}):j.map((e,t)=>(0,a.jsx)("button",{type:"button",onClick:t=>((e,t)=>{t.preventDefault(),t.stopPropagation(),n&&"function"==typeof n&&n(e[x]),h(!1),f("")})(e,t),className:"\n                    w-full px-3 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none cursor-pointer\n                    ".concat(e[x]===s?"bg-blue-50 text-blue-900":"text-gray-900","\n                  "),children:e[u]},e[x]||t))})]})]})}},78749:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(73365),r=s(1521),n=s(1702),l=s(34467),o=s(41633),c=s(21071),i=s(57353);function d(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),[s,d]=(0,r.useState)(!0),[m,u]=(0,r.useState)(!1),[x,g]=(0,r.useState)(""),[b,h]=(0,r.useState)(null),[p,f]=(0,r.useState)({openingStock:"",minimumStock:"",expiryDate:"",unit:""});(0,r.useEffect)(()=>{y()},[]);let y=async()=>{try{let t=await fetch("/api/stock/".concat(e.id));if(t.ok){let e=await t.json();h(e.stock),f({openingStock:e.stock.openingStock.toString(),minimumStock:e.stock.minimumStock.toString(),expiryDate:e.stock.expiryDate.split("T")[0],unit:e.stock.unit})}else g("Failed to fetch stock data")}catch(e){console.error("Error fetching stock data:",e),g("Failed to fetch stock data")}finally{d(!1)}},j=(e,t)=>{f(s=>({...s,[e]:t}))},N=async s=>{if(s.preventDefault(),g(""),!p.openingStock||p.openingStock<=0?(g("Opening stock must be greater than 0"),!1):!p.minimumStock||p.minimumStock<0?(g("Minimum stock must be 0 or greater"),!1):p.expiryDate?!!p.unit||(g("Please select a unit"),!1):(g("Please select an expiry date"),!1)){u(!0);try{let s=await fetch("/api/stock/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({stockId:e.id,openingStock:parseInt(p.openingStock),minimumStock:parseInt(p.minimumStock),expiryDate:p.expiryDate,unit:p.unit})});if(s.ok)await s.json(),alert("Stock updated successfully!"),t.push("/dashboard/stock");else{let e=await s.json();g(e.message||"Failed to update stock")}}catch(e){console.error("Error updating stock:",e),g("Failed to update stock")}finally{u(!1)}}},v=e=>new Intl.NumberFormat("en-IN").format(e);return s?(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,a.jsx)(l.A,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),(0,a.jsx)("div",{className:"space-y-3",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"h-12 bg-gray-200 rounded"},e))})]})})}):b?(0,a.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Edit Stock"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Update stock details for ",b.product," (",b.companyId,")"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(l.A,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Edit Stock Details"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[x&&(0,a.jsx)("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:x}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product"}),(0,a.jsx)(c.A,{value:b.product,disabled:!0,className:"bg-gray-50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),(0,a.jsx)(c.A,{value:b.companyId,disabled:!0,className:"bg-gray-50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opening Stock *"}),(0,a.jsx)(c.A,{type:"number",min:"0",value:p.openingStock,onChange:e=>j("openingStock",e.target.value),placeholder:"Enter opening stock quantity"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit *"}),(0,a.jsx)(i.A,{options:[{value:"packets",label:"Packets"},{value:"packs",label:"Packs"},{value:"kg",label:"Kilograms (kg)"}],value:p.unit,onChange:e=>j("unit",e),placeholder:"Select unit of measurement"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date *"}),(0,a.jsx)(c.A,{type:"date",value:p.expiryDate,onChange:e=>j("expiryDate",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Stock Level"}),(0,a.jsx)(c.A,{type:"number",min:"0",value:p.minimumStock,onChange:e=>j("minimumStock",e.target.value),placeholder:"Enter minimum stock level"})]}),(0,a.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,a.jsx)(o.A,{type:"submit",disabled:m,className:"flex-1",children:m?"Updating...":"Update Stock"}),(0,a.jsx)(o.A,{type:"button",variant:"outline",onClick:()=>{t.push("/dashboard/stock")},children:"Cancel"})]})]})]}),(0,a.jsxs)(l.A,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Stock Overview"}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Stock Formula"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,a.jsx)("p",{children:"Opening Stock + Purchases - Sales = Closing Stock"}),(0,a.jsxs)("p",{className:"mt-1 font-mono",children:[v(b.openingStock)," + ",v(b.totalPurchases)," - ",v(b.totalSales)," = ",v(b.closingStock)," ",b.unit]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"font-medium",children:"Opening Stock:"}),(0,a.jsxs)("span",{className:"font-mono",children:[v(b.openingStock)," ",b.unit]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Purchases:"}),(0,a.jsxs)("span",{className:"font-mono text-green-600",children:["+",v(b.totalPurchases)," ",b.unit]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Sales:"}),(0,a.jsxs)("span",{className:"font-mono text-red-600",children:["-",v(b.totalSales)," ",b.unit]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-blue-100 rounded border-2 border-blue-300",children:[(0,a.jsx)("span",{className:"font-bold",children:"Closing Stock:"}),(0,a.jsxs)("span",{className:"font-mono font-bold text-blue-800",children:[v(b.closingStock)," ",b.unit]})]})]}),b.agentStocks&&b.agentStocks.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Agent Stock Allocation"}),(0,a.jsx)("div",{className:"space-y-2",children:b.agentStocks.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 border rounded",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.agentName}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Agent ",t+1]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Allocated:"}),(0,a.jsxs)("span",{className:"font-mono ml-1",children:[v(e.stockAllocated)," ",b.unit]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Delivered:"}),(0,a.jsxs)("span",{className:"font-mono ml-1",children:[v(e.stockDelivered)," ",b.unit]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"In Hand:"}),(0,a.jsxs)("span",{className:"font-mono ml-1",children:[v(e.stockInHand)," ",b.unit]})]})]})]},t))})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Stock Status"}),(0,a.jsxs)("div",{className:"space-y-2",children:[b.isLowStock&&(0,a.jsx)("div",{className:"p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded",children:"⚠️ Low Stock Alert: Stock is below minimum level"}),b.isExpired&&(0,a.jsx)("div",{className:"p-3 bg-red-100 border border-red-400 text-red-800 rounded",children:"\uD83D\uDEA8 Expired Stock: Product has expired"}),!b.isLowStock&&!b.isExpired&&(0,a.jsx)("div",{className:"p-3 bg-green-100 border border-green-400 text-green-800 rounded",children:"✅ Stock Status: Normal"})]})]})]})]})]}):(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,a.jsx)(l.A,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Stock Not Found"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"The requested stock could not be found."}),(0,a.jsx)(o.A,{onClick:()=>t.push("/dashboard/stock"),children:"Back to Stock Dashboard"})]})})})}}},e=>{e.O(0,[96,358],()=>e(e.s=11145)),_N_E=e.O()}]);