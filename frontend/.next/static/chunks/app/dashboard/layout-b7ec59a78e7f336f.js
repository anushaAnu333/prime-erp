(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{24834:(e,t,r)=>{"use strict";function a(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function s(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e)}function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")}function o(e){return({admin:"Administrator",manager:"Manager",accountant:"Accountant",agent:"Agent"})[e]||e}function i(e){return({admin:"bg-red-100 text-red-800",manager:"bg-blue-100 text-blue-800",accountant:"bg-green-100 text-green-800",agent:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800"}r.d(t,{B9:()=>a,cb:()=>o,cn:()=>n,qP:()=>i,vv:()=>s})},28268:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(73365),s=r(1521),n=r(1702),o=r(34191),i=r(24834);let c=(0,s.createContext)(),l=()=>{let e=(0,s.useContext)(c);if(!e)throw Error("useSidebar must be used within a SidebarProvider");return e},h=e=>{let{children:t}=e,[r,n]=(0,s.useState)(!1);return(0,a.jsx)(c.Provider,{value:{isCollapsed:r,toggleSidebar:()=>{n(!r)}},children:t})},d=e=>{var t,r;let{user:s}=e,o=(0,n.useRouter)(),c=(0,n.usePathname)(),{isCollapsed:h,toggleSidebar:d}=l(),u=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),o.push("/login"),o.refresh()}catch(e){console.error("Logout failed:",e)}},m=["admin","manager","accountant"].includes(null==s?void 0:s.role)?[{name:"Dashboard",href:"/dashboard",icon:(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{name:"Sales",href:"/dashboard/sales",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{name:"Purchases",href:"/dashboard/purchases",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})},{name:"Stock",href:"/dashboard/stock",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})},{name:"Payments",href:"/payments",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})},{name:"Reports",href:"/reports",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{name:"Customers",href:"/dashboard/customers",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{name:"Vendors",href:"/dashboard/vendors",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})},{name:"Products",href:"/dashboard/products",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})},{name:"Settings",href:"/settings",icon:(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}]:[{name:"Dashboard",href:"/dashboard",icon:(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{name:"Create Sale",href:"/dashboard/sales/create",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})},{name:"Collect Payment",href:"/payments/collect",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})},{name:"My Stock",href:"/stock/my",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})},{name:"Today's Route",href:"/route",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"})})}];return(0,a.jsxs)("div",{className:"fixed left-0 top-0 h-full bg-white shadow-lg border-r border-gray-200 transition-all duration-300 z-50 ".concat(h?"w-16":"w-64"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[!h&&(0,a.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Prima ERP"}),(0,a.jsx)("button",{onClick:d,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:h?"M4 6h16M4 12h16M4 18h16":"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:h?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:null==s||null==(r=s.name)||null==(t=r.charAt(0))?void 0:t.toUpperCase()})})}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 truncate",children:null==s?void 0:s.name}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((0,i.qP)(null==s?void 0:s.role)),children:(0,i.cb)(null==s?void 0:s.role)})]})}),(0,a.jsx)("nav",{className:"flex-1 p-4 space-y-2",children:m.map(e=>{let t=c===e.href;return(0,a.jsxs)("a",{href:e.href,className:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ".concat(t?"bg-blue-50 text-blue-700 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"),children:[(0,a.jsx)("span",{className:"flex-shrink-0",children:e.icon}),!h&&(0,a.jsx)("span",{className:"font-medium",children:e.name})]},e.name)})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,a.jsxs)("button",{onClick:u,className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-red-50 hover:text-red-600 transition-colors w-full ".concat(h?"justify-center":""),children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!h&&(0,a.jsx)("span",{children:"Logout"})]})})]})},u=e=>{let{children:t}=e,{isCollapsed:r}=l();return(0,a.jsx)("div",{className:"transition-all duration-300 ".concat(r?"ml-16":"ml-64"),children:(0,a.jsx)("main",{className:"p-4 lg:p-6",children:t})})};function m(e){var t;let{children:r}=e,i=(0,n.useRouter)(),[c,l]=(0,s.useState)(null),[m,p]=(0,s.useState)(!0);if((0,s.useEffect)(()=>{(async()=>{try{let e=await (0,o.HW)();if(!e)return void i.push("/login");l(e)}catch(e){console.error("Auth check failed:",e),i.push("/login")}finally{p(!1)}})()},[i]),m)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!c)return null;let x={_id:null==(t=c._id)?void 0:t.toString(),name:c.name,email:c.email,role:c.role,phone:c.phone,companyAccess:c.companyAccess,isActive:c.isActive,createdAt:c.createdAt,updatedAt:c.updatedAt};return(0,a.jsx)(h,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d,{user:x}),(0,a.jsx)(u,{children:r})]})})}},34191:(e,t,r)=>{"use strict";r.d(t,{HW:()=>s});var a=r(37170);async function s(){try{return(await a.A.getCurrentUser()).user}catch(e){return console.error("Error getting current user:",e),null}}},37170:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let a="http://localhost:3001",s={LOGIN:"".concat(a,"/api/auth/login"),LOGOUT:"".concat(a,"/api/auth/logout"),ME:"".concat(a,"/api/auth/me"),SALES:"".concat(a,"/api/sales"),SALE_BY_ID:e=>"".concat(a,"/api/sales/").concat(e),CUSTOMERS:"".concat(a,"/api/customers"),CUSTOMER_BY_ID:e=>"".concat(a,"/api/customers/").concat(e),PRODUCTS:"".concat(a,"/api/products"),PRODUCT_BY_ID:e=>"".concat(a,"/api/products/").concat(e),DASHBOARD:"".concat(a,"/api/dashboard"),DASHBOARD_STATS:"".concat(a,"/api/dashboard/stats")};class n{getCachedData(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<3e5?t.data:null}setCachedData(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}clearCache(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.cache.delete(e):this.cache.clear()}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={credentials:"include",headers:{"Content-Type":"application/json"}},a={...r,...t,headers:{...r.headers,...t.headers}};try{let t=await fetch(e,a);if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){throw console.error("API request failed:",e),e}}async get(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(t){let t=this.getCachedData(e);if(t)return t}let r=await this.request(e);return t&&this.setCachedData(e,r),r}async post(e,t){return this.request(e,{method:"POST",body:JSON.stringify(t)})}async put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}async login(e){let t=await this.post(s.LOGIN,e);return this.clearCache(),t}async logout(){let e=await this.post(s.LOGOUT);return this.clearCache(),e}async getCurrentUser(){return this.get(s.ME,!1)}async getSales(){return this.get(s.SALES)}async getSale(e){return this.get(s.SALE_BY_ID(e))}async createSale(e){let t=await this.post(s.SALES,e);return this.clearCache(s.SALES),t}async updateSale(e,t){let r=await this.put(s.SALE_BY_ID(e),t);return this.clearCache(s.SALES),this.clearCache(s.SALE_BY_ID(e)),r}async deleteSale(e){let t=await this.delete(s.SALE_BY_ID(e));return this.clearCache(s.SALES),this.clearCache(s.SALE_BY_ID(e)),t}async getCustomers(){return this.get(s.CUSTOMERS)}async getCustomer(e){return this.get(s.CUSTOMER_BY_ID(e))}async createCustomer(e){let t=await this.post(s.CUSTOMERS,e);return this.clearCache(s.CUSTOMERS),t}async updateCustomer(e,t){let r=await this.put(s.CUSTOMER_BY_ID(e),t);return this.clearCache(s.CUSTOMERS),this.clearCache(s.CUSTOMER_BY_ID(e)),r}async deleteCustomer(e){let t=await this.delete(s.CUSTOMER_BY_ID(e));return this.clearCache(s.CUSTOMERS),this.clearCache(s.CUSTOMER_BY_ID(e)),t}async getProducts(){return this.get(s.PRODUCTS)}async getProduct(e){return this.get(s.PRODUCT_BY_ID(e))}async createProduct(e){let t=await this.post(s.PRODUCTS,e);return this.clearCache(s.PRODUCTS),t}async updateProduct(e,t){let r=await this.put(s.PRODUCT_BY_ID(e),t);return this.clearCache(s.PRODUCTS),this.clearCache(s.PRODUCT_BY_ID(e)),r}async deleteProduct(e){let t=await this.delete(s.PRODUCT_BY_ID(e));return this.clearCache(s.PRODUCTS),this.clearCache(s.PRODUCT_BY_ID(e)),t}async getDashboardStats(){return this.get(s.DASHBOARD_STATS)}async getDashboard(){return this.get(s.DASHBOARD)}constructor(){this.baseURL="http://localhost:3001",this.cache=new Map}}let o=new n},97026:(e,t,r)=>{Promise.resolve().then(r.bind(r,28268))}},e=>{e.O(0,[96,358],()=>e(e.s=97026)),_N_E=e.O()}]);